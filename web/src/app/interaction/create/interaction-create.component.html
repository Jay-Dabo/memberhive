<form class="interaction-form"
      [formGroup]="interactionForm"
      novalidate
      (ngSubmit)="save(interactionForm.value, interactionForm.valid)">

  <md-card>
    <md-card-content>
      <div class="mat-input-wrapper muted" *ngIf="editMode">
        <b i18n>Created:</b> {{interaction.createdAt}},
        <b i18n>Updated:</b> {{interaction.updatedAt}}
      </div>

      <div class="mat-input-wrapper">
        <mh-tinymce [elementId]="'interaction-editor'"
                    [inline]="false"
                    formControlName="text"></mh-tinymce>
      </div>

      <div class="mat-input-wrapper" fxFlex>
        <label i18n for="typeSelect">Type:</label>
        <md-button-toggle-group id="typeSelect" formControlName="type">
          <md-button-toggle value="{{interactionType.id}}"
                            mdTooltip="{{interactionType.type | uppercase}}"
                            *ngFor="let interactionType of options.interaction.types">
            <md-icon>{{interactionType.iconString}}</md-icon>
          </md-button-toggle>
        </md-button-toggle-group>
      </div>

      <div class="mat-input-wrapper" fxFlex fxLayout="row">
        <md-select placeholder="Relates to" i18n-placeholder formControlName="owner">
          <md-option *ngFor="let person of people$ | async" [value]="person.uid">
            {{person.fullName}}
          </md-option>
        </md-select>

        <md-select placeholder="Assign to" i18n-placeholder formControlName="recipients" multiple>
          <md-option *ngFor="let person of people$ | async" [value]="person.uid">
            {{person.fullName}}
          </md-option>
        </md-select>
      </div>

      <md-input-container>
        <input [mdDatepicker]="minDatePicker"
               mdInput
               placeholder="Complete by"
               i18n-placeholder
               formControlName="dueOn">
        <button mdSuffix [mdDatepickerToggle]="minDatePicker"></button>
      </md-input-container>
      +<md-datepicker #minDatePicker></md-datepicker>
    </md-card-content>
    <md-card-actions>
      <button
              md-raised-button
              type="submit"
              color="primary"
              [disabled]="!interactionForm.valid">
        <span *ngIf="!editMode" i18n>Notify</span>
        <span *ngIf="editMode" i18n>Update</span>
      </button>
      <button md-raised-button
              md-button
              (click)="clearForm()"
              *ngIf="!editMode"
              i18n>
        <md-icon>clear</md-icon> Clear</button>
      <button md-button
              md-button
              *ngIf="returnToRoute"
              [routerLink]="[returnToRoute]"
              i18n>
        <md-icon>arrow_back</md-icon> Cancel</button>
    </md-card-actions>
  </md-card>

</form>
<pre *ngIf="error">{{ error | json }}</pre>